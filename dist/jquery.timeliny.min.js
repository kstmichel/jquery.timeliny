(function(d,c,a,e){function b(i,l){var g=i;var C=d(i);var m=C.children();l=d.extend({},d.fn.timeliny.defaults,l);function o(){p("onInit");if(l.hideBlankYears===false){y()}z();q();D();h();B();r();w();j();v();k()}function u(){m.detach().sort(function(F,E){return l.order==="asc"?d(F).data("year")-d(E).data("year"):d(E).data("year")-d(F).data("year")});C.append(m)}function k(){C.addClass("loaded");var F=d(".timeliny-timeline");d(F).addClass("year-view");d(".originalFrame").removeClass("originalFrame").addClass("visibleEvent");var H=C.find("."+l.className+"-timeblock.active").first().attr("data-year");var E=C.find("."+l.className+"-timeblock.active").first().attr("data-month");var G=C.find("."+l.className+"-timeblock.active").first().attr("data-week");console.log("curr mark",H,E,G);p("afterLoad",[H,E,G]);w()}var f=true;var n=false;var A=false;function z(){console.debug("_granularity ENTER");var E=d(".granularity-years");var F=d(".granularity-months");var G=d(".granularity-weeks");d(E).click(function(){var K=d(".timeliny-timeline");var H=d(".timeliny-timeblock");var I=d(".timeliny-dot");var M=d(".timeliny-timeblock.active").attr("data-year");var L=d(".inactive-month");var J=d(".inactive-week");console.debug("years button clicked ~!~!~!~!~!~!~!~!~!~!~!~");n=false;A=false;f=true;d(K).addClass("year-view");d(K).removeClass("weeks-view month-view");d(H).removeClass("firstFrame");d(I).removeClass("clicked");d(F).attr("disabled",false);d(G).attr("disabled",false);d(L).remove();d(J).remove();console.log("remove ghost months from view");d(H).each(function(){if(d(this).attr("data-year")!==M){d(this).show()}});y();w();B()});d(F).click(function(){var M=d(".timeliny-timeline");var H=d(".timeliny-timeblock");var J=d(".timeliny-timeblock.active").attr("data-year");var L=d(".extra_events");var I=d(".timeliny-dot");var K=d(".inactive-week");f=false;A=false;n=true;console.debug("months button clicked ~!~!~!~!~!~!~!~!~!~!~!~");d(E).attr("disabled",false);d(G).attr("disabled",false);d(M).removeClass("year-view weeks-view");d(M).addClass("month-view");d(L).removeClass("active");d(H).removeClass("extra_events initial_events");d(I).remove();d(K).remove();d(H).each(function(){if(d(this).attr("data-year")!==J){d(this).removeClass("visibleEvent");d(this).hide();console.log("remove visible from hidden years",J)}else{if(d(this).attr("data-month")==d(".visibleEvent").attr("data-month")){console.log("remove extra months");d(this).last().hide()}else{d(this).addClass("visibleEvent")}}});y();w();B()});d(G).click(function(){var J=d(".timeliny-timeline");var H=d(".timeliny-timeblock");var M=d(".timeliny-timeblock.active");var L=d(M).attr("data-year");var I=d(M).attr("data-month");var N=d(J).find("[data-month= "+I+"]");var K=d(".inactive-month");console.log("weeks btn clicked ~!~!~!~!~!~!~!~!~!~!~!~");f=false;n=false;A=true;d(E).attr("disabled",false);d(F).attr("disabled",false);d(G).attr("disabled",true);d(J).removeClass("year-view month-view");d(J).addClass("weeks-view");d(H).removeClass("visibleEvent");d(N).addClass("visibleEvent");d(K).remove();console.log("activeMonth",I);d(H).each(function(){if(d(this).attr("data-year")!==L){d(this).hide()}if(d(this).attr("data-month")!==I){d(this).hide()}else{d(this).addClass("visibleEvent")}});y();w();B()})}function y(){var R=d(".granularity-years");var aj=d(".granularity-months");var Y=d(".granularity-weeks");var K=d(".timeliny-timeline");var ah=d(".timeliny-timeblock");var Z=d(".timeliny-dot");var ae=d(".active");var P;var Q;var N;var G;var ag;var ad;var X;var aa;var J;var F;var M;var W;var E;if(f===true){var V=2008;var I=2020;N=V;G=I;P=0;ad=[];E=d(".visibleEvent");P=0;d(R).attr("disabled",true);d(E).each(function(){if(P===0){ad.push(d(this).attr("data-year"));P++}if(d(this).attr("data-year")!==ad[P-1]){ad.push(d(this).attr("data-year"));P++}});P=0;console.debug("eventsLog for Years",ad)}if(n===true){var ab=1;var S=12;N=ab;G=S;E=d(".visibleEvent");P=0;M=d(".timeliny-timeblock.active");F=d(M).attr("data-year");var U=m.parent().find("[data-year="+F+"]");ad=[];ad.length=0;d(aj).attr("disabled",true);console.debug("month frames initialized");console.log("clear log",ad,U);var ai=d(M).attr("data-month");d(E).each(function(){M=d(".timeliny-timeblock.active");F=d(M).attr("data-year");var ak=d(this).attr("data-month");if(d.inArray(ak,ad)==-1){ad.push(d(this).attr("data-month"));P++}});P=0;console.debug("eventsLog for Months",ad)}if(A===true){var ac=1;var L=4;N=ac;G=L;P=0;F=d(".active").attr("data-year");W=d(".active").attr("data-month");console.debug("Adding weeksView ghost frames");d(Y).attr("disabled",true);M=d(".timeliny-timeblock.active");var af=d(K).find("[data-year= "+F+"][data-month="+W+"]").not(Z);ad=[];ad.length=0;console.log("clear log",ad,af,F,W);d(af).each(function(){console.log("weeks log");if(d(this).attr("data-month")!==ad[P-1]){console.log("add to list");ad.push(d(this).attr("data-week"));P++}});console.debug("eventsLog for Weeks",ad);X=m.parent().parent().find("[data-week="+(T-1)+"]").not(Z);ag=m.parent().parent().find("[data-week="+T+"]").not(Z);F=d(ag).attr("data-year");W=d(ag).attr("data-month");J='<div data-year="'+F+'" data-month="'+W+'" data-week="'+T+'" class="inactive"></div>'}if(l.order==="asc"){console.debug("ascending list---STATS",N,G);for(var T=N;T<G+1;T++){F=d(M).attr("data-year");W=d(M).attr("data-month");console.debug("trigger loop",T,N,G);if(f===true){console.log("Adding yearsView ghost frames");Q="timeliny-year";X=m.parent().parent().find("[data-year="+(T-1)+"]").not(Z);aa=m.parent().parent().find("[data-year="+(T+1)+"]").not(Z);ag=m.parent().parent().find("[data-year="+T+"]").not(Z);J='<div data-year="'+T+'" data-month="1" class="inactive inactive-year">'+T+" ghost frame</div>";m=C.children()}if(n===true){console.log("Adding monthsView ghost frames");Q="timeliny-month";N=ab;G=S;X=m.parent().parent().find("[data-year="+F+"][data-month="+(T-1)+"]").not(Z);ag=m.parent().parent().find("[data-year="+F+"][data-month="+T+"]").not(Z);J='<div data-year="'+F+'" data-month="'+T+'" class="inactive inactive-month">'+T+" ghost frame</div>"}if(A===true){console.debug("Adding weeksView ghost frames");N=ac;G=L;Q="timeliny-week";X=m.parent().parent().find("[data-year="+F+"][data-month="+W+"][data-week="+(T-1)+"]").not(Z);ag=m.parent().parent().find("[data-year="+F+"][data-month="+W+"][data-week="+T+"]").not(Z);J='<div data-year="'+F+'" data-month="'+W+'" data-week="'+T+'" class="inactive inactive-week">'+T+" ghost frame</div>"}if(d(ag).length<=0){console.log("not detecting event...");if(T>N){console.log("y is > than firstFrame",T,N);d(X).last().after(J)}else{console.log("y is firstFrame",T,N);console.debug("PLACEMENT...");if(f==true){console.debug("Years configuration");m.first().before(J).addClass("firstFrame ")}if(n==true){console.debug("Months configuration");d(K).find('[data-year="'+F+'"]').first().not(Z).before(J).addClass("firstFrame ")}if(A==true){console.debug("Weeks configuration",F,W,T);d(K).find('[data-year="'+F+'"][data-month="'+W+'"]').first().not(Z).before(J).addClass("firstFrame ")}}}else{console.debug("event exists...",T,P,ad);d(ag).show();if(T==ad[P]){console.debug("y Equal to EventLog, print no frame",T,"===",ad[P],P);console.debug("Mark extra events",d(".extra_events"));if(d(ag).length>=2){d(ag).first().addClass("initial_events");d(ag).not(":first").addClass("extra_events")}if(d(ag).length===1){d(ag).first().addClass("only_event").removeClass("initial_events")}if(d(ag).hasClass("only_event")||d(ag).hasClass("initial_events")){P++;console.debug("not Only Event: add to index:",P,ad[P])}else{console.debug("has only_event")}}}}}else{for(var T=N;T>=G;T--){if(d(ag).length<=0){if(T<V){d(aa).after(J)}else{m.first().before(J)}}}}if(f===true){var H=d(".timeliny-timeblock.extra_events");var O=d(".timeliny-timeblock.initial_events");d(H).each(function(){console.debug("extraEvents...removed month attributes",F,W);if(d(this).attr("data-year")==F){d(this).first().addClass("active")}});d(O).each(function(){console.debug("initialEvents....",F,W);if(d(this).attr("data-year")==F){d(this).addClass("active")}})}D()}function q(){return C.addClass(l.className).children().wrapAll(l.wrapper).wrapAll('<div class="'+l.className+'-timeline"></div>')}function h(){var E=C.css("padding-top").replace("px","")*0.8;C.find("."+l.className+"-timeline").css("width",""+(m.length*E)+"px");C.find("."+l.className+"-timeliny-timeblock").css("width",""+E+"px")}function D(){console.debug("initialize dots...");m=d(".timeliny-timeline").children();m.each(function(){var K=d(this).html();var H=d(this).attr("data-year");var J=d(this).attr("data-month");var G=d(this).attr("data-week");var F=d(this).find(".timeliny-dot");var E;var I=H+J;if(d(K).length){E='<a href="#'+I+'" class="'+l.className+'-dot" data-year="'+H+'" data-month="'+J+'" data-week="'+G+'" data-text="  "></a>'}else{E='<a href="#'+I+'" class="'+l.className+'-dot" data-year="'+H+'" data-month="'+J+'" data-week="'+G+'" data-text="'+K+'"></a>'}d(this).addClass(""+l.className+"-timeblock").html(E)})}function r(){C.append('<div class="'+l.className+'-vertical-line"></div>')}function w(J){var E=C.find("."+l.className+"-vertical-line").position().left;var G=C.find("."+l.className+"-timeblock.active").position().left;var F=C.find("."+l.className+"-timeblock.active ."+l.className+"-dot").width()/2;console.log("timeblock active where are you",d(".timeliny-timeblock.active"));var I=G-E;var H;if(I>0){H="-"+(Math.abs(I)+F+1)+""}else{H="+"+(Math.abs(I)-F-1)+""}C.find("."+l.className+"-timeline").animate({left:H},l.animationSpeed,function(){if(typeof J!="undefined"){if(J==="click"){var N=C.find("."+l.className+"-timeblock.active").first().attr("data-year");var K=C.find("."+l.className+"-timeblock.active").first().attr("data-month");var M=C.find("."+l.className+"-timeblock.active").first().attr("data-week");var L=N+K+M;console.debug("CLICKEDDDDDDDDD","years",f,"months",n,"weeks",A,"current",L);p("afterChange",[L]);console.log(p,[L])}else{if(J==="resize"){p("afterResize")}}}})}function B(){m.parent().find("."+l.className+"-timeblock:not(.inactive) ."+l.className+"-dot").on("click",function(M){M.preventDefault();var I=d(this).parent().parent().find("."+l.className+"-timeblock.active");var P=d(this).parent().parent().find("."+l.className+"-timeblock.active").attr("data-year");var F=d(this).parent().parent().find("."+l.className+"-timeblock.active").attr("data-month");var H=d(this).parent().parent().find("."+l.className+"-timeblock.active").attr("data-week");var N=P+F+H;var O=d(this).attr("data-year");var L=d(this).attr("data-month");var G=d(this).attr("data-week");var J=O+L+G;d(this).toggleClass("clicked");var K=P+F+H;var E=O+L+G;if(N!=J){p("onLeave",[K,E]);d(I).removeClass("active");d(this).closest("."+l.className+"-timeblock").addClass("active")}w("click");return false})}function j(){function E(H,F){var G;return function(){var I=arguments;var J=this;clearTimeout(G);G=setTimeout(function(){H.apply(J,I)},F)}}d(c).on("resize.timeliny",E(function(){w("resize")},350))}function v(){var I=null,H=0,J=0;function F(K){I=K;J=H-I.offsetLeft}function E(K){H=a.all?c.event.clientX:K.pageX;if(I!==null){I.style.left=(H-J)+"px"}}function G(){if(I){var K=C.find("."+l.className+"-vertical-line").offset().left;var L=null;var M=1e+23;C.find("."+l.className+"-dot[data-year="+L+"]").trigger("click");I=null}}C.first().on("mousedown",function(){F(C.find("."+l.className+"-timeline")[0]);return false});d(a).on("mousemove.timeliny",function(K){E(K)});d(a).on("mouseup.timeliny",function(){G()})}function t(F){var E=C.find("."+l.className+"-timeblock[data-year="+F+"]:not(.inactive) ."+l.className+"-dot").first();if(E.length>0){E.trigger("click")}}function s(E,F){if(F){l[E]=F}else{return l[E]}}function x(){C.each(function(){var F=this;var E=d(this);d(c).off("resize.timeliny");E.find("."+l.className+"-timeblock:not(.inactive) ."+l.className+"-dot").off("click");d(a).off("mousemove.timeliny");d(a).off("mouseup.timeliny");E.first().off("mousedown");E.remove();p("onDestroy");E.removeData("plugin_timeliny")})}function p(F,E){if(l[F]!==e){l[F].apply(g,E)}}o();return{option:s,destroy:x,goToYear:t}}d.fn.timeliny=function(h){console.log(h);if(typeof arguments[0]==="string"){var f=arguments[0];var g=Array.prototype.slice.call(arguments,1);var i;this.each(function(){if(d.data(this,"plugin_timeliny")&&typeof d.data(this,"plugin_timeliny")[f]==="function"){i=d.data(this,"plugin_timeliny")[f].apply(this,g)}else{throw new Error("Method "+f+" does not exist on jQuery.timeliny")}});if(i!==e){return i}else{return this}}else{if(typeof h==="object"||!h){return this.each(function(){if(!d.data(this,"plugin_timeliny")){d.data(this,"plugin_timeliny",new b(this,h))}})}}};d.fn.timeliny.defaults={order:"asc",className:"timeliny",wrapper:'<div class="timeliny-wrapper"></div>',boundaries:2,animationSpeed:250,hideBlankYears:false,onInit:function(){},onDestroy:function(){},afterLoad:function(h,f,g){},onLeave:function(g,f){},afterChange:function(f){},afterResize:function(){}}})(jQuery,window,document);